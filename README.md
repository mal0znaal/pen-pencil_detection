# Тестовое задание "Детекция карандашей и ручек"

Цель: обучить и сравнить несколько моделей YOLO для детекции двух классов — **ручка** (`pen`) и **карандаш** (`pencil`) — на своих данных, а затем проверить качество на отдельном тестовом видео (и в реальном времени).

---

## 1. Постановка задачи

Техническое задание:

- Записать **два видео по ~30 секунд** с ручками и карандашами на столе:
  - первое видео — для формирования обучающего датасета;
  - второе — для финальной проверки модели.
- Выбрать **60 кадров** из первого видео:
  - 50 изображений в `train`;
  - 10 изображений в `val`.
- Разметить изображения:
- Обучить несколько моделей YOLO на GPU.
- Оценить метрики и ответить:
  - какая модель лучше;
  - как она ведёт себя на втором видео;
  - попробовать запустить модель в real-time.

---

## 2. Данные

### 2.1 Сбор

Было записано два видео:

- **video_train.mp4** — ~30 секунд, 3 ручки и 2 карандаша на столе, разные ракурсы и движения камеры. На некоторых кадрах предметы частично (или полностью) пропадают из зоны выдимости
- **video_test.mp4** — второе видео в отличающихся условиях:
  - немного другое расположение предметов;
  - частично другие фоны/углы.

### 2.2 Разметка

Разметка выполнялась в сервисе **Roboflow**, для ускорения этого этапа применялась модель **SAM3** для автоматической разметки. После работы **SAM3** каждое изображение проверялось и корректировалось вручную. Ссылка на датасет: https://app.roboflow.com/testproject-64hot/pen_penicl1-4izcj/1

Разделение на выборки:
- **train** — 50 изображений;
- **val** — 10 изображений.

---

## 3. Обучение модели

### 3.1 Первый эксперимент

После получение готового набора данных, была обучена модель **YOLO12s** на 50 эпохах. Все гиперпараметры обучения стандартные, кроме:  
- **Batch_size** выбирался автоматически, чтобы занимать **75%** VRAM
- **imgsz** = 640. Изображения сжимались до 640 пикселей по ширине с сохранением пропорций.

Цель - получить базовую модель без специального тюнинга и аугментаций а после понять, как предобученная YOLO12s справляется с задачей на данном датасете. 

| Class  | Precision (P) | Recall (R) | mAP@0.5 | mAP@0.5:0.95 |   F1   |
|--------|---------------|------------|---------|--------------|--------|
| all    | 0.996         | 0.985      | 0.995   | 0.869        | 0.9908 |
| pen    | 1.000         | 0.971      | 0.995   | 0.903        | ------ |
| pencil | 0.993         | 1.000      | 0.995   | 0.835        | ------ |

Результаты на вылидационной выборке оказались хорошими, однако для точной оценки результата стоит проверить как модель покажет себя в боевых условиях (второе видео, записанное для тестирования). И с этим возникают проблемы: Модель хорошо выделяет `bound boxes`, но ошибается в классификации. Один определенный карандаш ошибочно определяется за ручку.


